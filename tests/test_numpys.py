from adams_text_utils import *
import numpy as np


def test_numpy_arrays():
    arr = np.asarray([[0.01346473, 0.22654731, 0.24858536],
                      [0.64985173, 0.8378816, 0.6764337],
                      [0.77706594, 0.48403015, 0.51463447]])

    a="""[[0.01, 0.23, 0.25],
 [0.65, 0.84, 0.68],
 [0.78, 0.48, 0.51]]
"""
    assert dump_ndarray_precision(arr, precision=2, indent_size=0) == a

    a="""[[
   0.01, 0.23, 0.25
], [
   0.65, 0.84, 0.68
], [
   0.78, 0.48, 0.51
]]
"""
    assert dump_ndarray_precision(arr, precision=2, indent_size=0, big_indent_size=3) == a

    a="""   [[1/50, 5/22, 1/4],
    [13/20, 31/37, 23/34],
    [7/9, 15/31, 18/35]]
"""
    assert dump_ndarray_rational(arr, max_denominator=50, indent_size=3) == a

    arr = np.random.rand(3, 24)
    arr = np.asarray([[5 / 6, 1 / 3, 0, 8 / 9, 5 / 9,
            1 / 4, 1 / 6, 2 / 5, 2 / 7, 1,
            5 / 6, 5 / 8, 4 / 5, 5 / 8, 1 / 10,
            7 / 9, 2 / 3, 1 / 10, 1 / 7, 1 / 2,
            1 / 10, 3 / 8, 5 / 9, 1 / 4],
           [1, 9 / 10, 1 / 3, 5 / 7, 1,
            5 / 9, 5 / 6, 9 / 10, 6 / 7, 5 / 7,
            1 / 6, 9 / 10, 9 / 10, 0, 5 / 9,
            9 / 10, 1, 3 / 7, 9 / 10, 1 / 9,
            4 / 7, 1 / 2, 9 / 10, 4 / 5],
           [5 / 6, 4 / 5, 5 / 7, 5 / 9, 5 / 9,
            9 / 10, 7 / 9, 5 / 6, 1 / 2, 1 / 4,
            4 / 7, 0, 1 / 10, 1 / 6, 4 / 5,
            2 / 3, 1, 4 / 9, 3 / 7, 3 / 5,
            2 / 7, 3 / 5, 1 / 10, 1]])

    a="""   arr = np.asarray([[ 5/6, 1/3,   0, 8/9,  5/9, 1/4, 1/6,  2/5, 2/7,   1, 
                       5/6, 5/8, 4/5, 5/8, 1/10, 7/9, 2/3, 1/10, 1/7, 1/2, 
                      1/10, 3/8, 5/9, 1/4],
                     [  1, 9/10,  1/3, 5/7,   1,  5/9, 5/6, 9/10,  6/7, 5/7, 
                      1/6, 9/10, 9/10,   0, 5/9, 9/10,   1,  3/7, 9/10, 1/9, 
                      4/7,  1/2, 9/10, 4/5],
                     [5/6, 4/5,  5/7, 5/9, 5/9, 9/10, 7/9, 5/6, 1/2, 1/4, 
                      4/7,   0, 1/10, 1/6, 4/5,  2/3,   1, 4/9, 3/7, 3/5, 
                      2/7, 3/5, 1/10,   1]]
"""
    assert dump_ndarray_rational(arr, max_denominator=10, indent_size=3, first_line="arr = np.asarray(")==a

    a="""   arr = np.asarray([[
      5/6, 1/3,   0, 8/9,  5/9, 1/4, 1/6,  2/5, 2/7,   1, 
      5/6, 5/8, 4/5, 5/8, 1/10, 7/9, 2/3, 1/10, 1/7, 1/2, 
     1/10, 3/8, 5/9, 1/4
   ], [
       1, 9/10,  1/3, 5/7,   1,  5/9, 5/6, 9/10,  6/7, 5/7, 
     1/6, 9/10, 9/10,   0, 5/9, 9/10,   1,  3/7, 9/10, 1/9, 
     4/7,  1/2, 9/10, 4/5
   ], [
     5/6, 4/5,  5/7, 5/9, 5/9, 9/10, 7/9, 5/6, 1/2, 1/4, 
     4/7,   0, 1/10, 1/6, 4/5,  2/3,   1, 4/9, 3/7, 3/5, 
     2/7, 3/5, 1/10,   1
   ]]
"""
    assert dump_ndarray_rational(arr, max_denominator=10, indent_size=3, big_indent_size=2, first_line="arr = np.asarray(")==a

    arr = [95, 52, 17, 68, 23, 77, 18, 74, 75, 7, 36, 72, 40, 34, 91, 35, 92, 16, 70, 27,
           13, 78, 64, 63, 53, 95, 98, 98, 3, 55, 46, 10, 91, 4]


    a = """   arr = [95, 52, 17, 68, 23, 
          77, 18, 74, 75,  7, 
          36, 72, 40, 34, 91, 
          35, 92, 16, 70, 27, 
          13, 78, 64, 63, 53, 
          95, 98, 98,  3, 55, 
          46, 10, 91,  4]"""
    assert dump_ndarray_int(arr, indent_size=3, first_line="arr = ", max_line_size=30) == a
    a = """   arr = [95, 52, 17, 68, 23, 77, 18, 74, 75,  7, 
          36, 72, 40, 34, 91, 35, 92, 16, 70, 27, 
          13, 78, 64, 63, 53, 95, 98, 98,  3, 55, 
          46, 10, 91,  4]"""
    assert dump_ndarray_int(arr, indent_size=3, first_line="arr = ", max_line_size=50) == a


if __name__ == '__main__':
    test_numpy_arrays()
